const a=document.body,b=document.getElementById('dropArea');let c={1:null,2:null,3:null};a.addEventListener('dragover',d=>{d.preventDefault();d.dataTransfer.dropEffect='copy';b&&b.classList.add('dragover')});a.addEventListener('dragleave',d=>{b&&!a.contains(d.relatedTarget)&&b.classList.remove('dragover')});a.addEventListener('drop',d=>{d.preventDefault();b&&b.classList.remove('dragover');var e=d.dataTransfer.files;getFiles(e)});const getFiles=d=>{if(d.length===0)return;const e=d.length,f=document.getElementById('dropArea');f&&(f.innerHTML=`<div class="drop-text">âœ… ${e}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ä¸­...</div><div class="drop-subtext">ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„</div>`);let g=0;for(const h of d){const i=new FileReader;i.readAsText(h,'shift-jis');i.onload=j=>{let k=j.target.result;if(k.indexOf('ARC4 Manager Race Data')!==0&&k.indexOf('ARC4 Manager User List')!==0){const l=new FileReader;l.readAsText(h,'utf-8');l.onload=m=>{k=m.target.result;(k.indexOf('ARC4 Manager Race Data')==0||k.indexOf('ARC4 Manager User List')==0)&&(document.getElementById('ta').value=document.getElementById('ta').value+'\n'+k);g++;g===e&&f&&(f.innerHTML=`<div class="drop-text">âœ… ${e}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£å¸¸ã«èª­ã¿è¾¼ã¿ã¾ã—ãŸ</div><div class="drop-subtext">é›†è¨ˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦çµæœã‚’è¡¨ç¤ºã—ã¦ãã ã•ã„</div>`)};return}(k.indexOf('ARC4 Manager Race Data')==0||k.indexOf('ARC4 Manager User List')==0)&&(document.getElementById('ta').value=document.getElementById('ta').value+'\n'+k);g++;g===e&&f&&(f.innerHTML=`<div class="drop-text">âœ… ${e}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£å¸¸ã«èª­ã¿è¾¼ã¿ã¾ã—ãŸ</div><div class="drop-subtext">é›†è¨ˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦çµæœã‚’è¡¨ç¤ºã—ã¦ãã ã•ã„</div>`)};i.onerror=()=>{g++;g===e&&f&&(f.innerHTML=`<div class="drop-text">âš ï¸ ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼</div><div class="drop-subtext">ã‚‚ã†ä¸€åº¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„</div>`)}}};function updateRaceAreas(){const d=document.querySelector('input[name="raceCount"]:checked').value,e=document.getElementById('singleRaceArea'),f=document.getElementById('multiRaceArea'),g=document.getElementById('raceArea2'),h=document.getElementById('raceArea3');d==='1'?(e.style.display='block',f.style.display='none'):(e.style.display='none',f.style.display='block',g.style.display=d>='2'?'block':'none',h.style.display=d>='3'?'block':'none');c={1:null,2:null,3:null};document.getElementById('ta').value='';document.getElementById('table1').innerHTML='';d>'1'&&setupMultiRaceDropAreas()}function setupMultiRaceDropAreas(){const d=parseInt(document.querySelector('input[name="raceCount"]:checked').value);for(let e=1;e<=d;e++){const f=document.getElementById(`dropAreaRace${e}`);if(f){const g=f.cloneNode(true);f.parentNode.replaceChild(g,f);setupRaceDropArea(e)}}}function setupRaceDropArea(d){const e=document.getElementById(`dropAreaRace${d}`);e.addEventListener('dragover',f=>{f.preventDefault();f.dataTransfer.dropEffect='copy';e.classList.add('dragover')});e.addEventListener('dragleave',f=>{e.contains(f.relatedTarget)||e.classList.remove('dragover')});e.addEventListener('drop',f=>{f.preventDefault();e.classList.remove('dragover');const g=f.dataTransfer.files;getRaceFiles(g,d)})}function getRaceFiles(d,e){if(d.length===0)return;const f=['','Aãƒ¡ã‚¤ãƒ³','Bãƒ¡ã‚¤ãƒ³','Cãƒ¡ã‚¤ãƒ³'],g=document.getElementById(`dropAreaRace${e}`);g&&(g.innerHTML=`<div class="drop-text">âœ… ${f[e]}èª­ã¿è¾¼ã¿ä¸­...</div><div class="drop-subtext">ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„</div>`);let h=0,i='';for(const j of d){const k=new FileReader;k.readAsText(j,'shift-jis');k.onload=l=>{let m=l.target.result;if(m.indexOf('ARC4 Manager Race Data')!==0&&m.indexOf('ARC4 Manager User List')!==0){const n=new FileReader;n.readAsText(j,'utf-8');n.onload=o=>{m=o.target.result;(m.indexOf('ARC4 Manager Race Data')==0||m.indexOf('ARC4 Manager User List')==0)&&(i+=m+'\n');h++;h===d.length&&(c[e]=i,g&&(g.innerHTML=`<div class="drop-text">âœ… ${f[e]}èª­ã¿è¾¼ã¿å®Œäº†</div><div class="drop-subtext">ä»–ã®ãƒ¬ãƒ¼ã‚¹ã‚‚èª­ã¿è¾¼ã‚“ã§ã‹ã‚‰é›†è¨ˆã—ã¦ãã ã•ã„</div>`),updateTextArea())};return}(m.indexOf('ARC4 Manager Race Data')==0||m.indexOf('ARC4 Manager User List')==0)&&(i+=m+'\n');h++;h===d.length&&(c[e]=i,g&&(g.innerHTML=`<div class="drop-text">âœ… ${f[e]}èª­ã¿è¾¼ã¿å®Œäº†</div><div class="drop-subtext">ä»–ã®ãƒ¬ãƒ¼ã‚¹ã‚‚èª­ã¿è¾¼ã‚“ã§ã‹ã‚‰é›†è¨ˆã—ã¦ãã ã•ã„</div>`),updateTextArea())};k.onerror=()=>{h++;h===d.length&&g&&(g.innerHTML=`<div class="drop-text">âš ï¸ ${f[e]}èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼</div><div class="drop-subtext">ã‚‚ã†ä¸€åº¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„</div>`)}}}function updateTextArea(){const d=parseInt(document.querySelector('input[name="raceCount"]:checked').value);let e='';if(d===1)return;for(let f=1;f<=d;f++)c[f]&&(e+=c[f]);document.getElementById('ta').value=e}function switchDisplay(d){let e=document.getElementsByClassName("inputArea")[0],f=document.getElementById('btn');(e.style.display==='none'||d==1)?(e.style.display='block',f.innerHTML='ğŸ“Š å°åˆ·ç”¨è¡¨ç¤ºã«åˆ‡ã‚Šæ›¿ãˆã‚‹'):(e.style.display='none',f.innerHTML='ğŸ“ å…¥åŠ›ç”»é¢ã«æˆ»ã‚‹')}function clear1(){document.getElementById('ta').value='';document.getElementById('table1').innerHTML='';const d=document.getElementById('postToXBtn');d&&(d.style.display='none');const e=document.getElementById('generateImageBtn');e&&(e.style.display='none');q=null;c={1:null,2:null,3:null};const f=document.getElementById('dropArea');f&&(f.innerHTML=`<div class="drop-text">ğŸ“ ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</div><div class="drop-subtext">ARC4 Managerã®çµæœãƒ•ã‚¡ã‚¤ãƒ« (.csv ã¾ãŸã¯ .arc4) ã‚’æ”¾ã‚Šè¾¼ã‚“ã§ãã ã•ã„</div><div class="drop-subtext">è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€åº¦ã«ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™</div>`);const g=['','Aãƒ¡ã‚¤ãƒ³','Bãƒ¡ã‚¤ãƒ³','Cãƒ¡ã‚¤ãƒ³'];for(let h=1;h<=3;h++){const i=document.getElementById(`dropAreaRace${h}`);i&&(i.innerHTML=`<div class="drop-text">ğŸ“ ${g[h]}ã®çµæœãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—</div><div class="drop-subtext">${g[h]}ã®ãƒ¬ãƒ¼ã‚¹çµæœãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ”¾ã‚Šè¾¼ã‚“ã§ãã ã•ã„</div>`)}switchDisplay(1)}function postToX(){if(!q){alert('æŠ•ç¨¿ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚å…ˆã«é›†è¨ˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');return}const d=q;d.isMultiRace?postMultiRaceToX(d):postSingleRaceToX(d)}function postSingleRaceToX(d){let e='';e+=`ğŸ ${d.title}\n`;d.mode==1?e+=`âš¡ ãƒ™ã‚¹ãƒˆãƒ©ãƒƒãƒ— ${d.style} ã‚¹ã‚¿ãƒ¼ãƒˆ\n\n`:e+=`ğŸƒ å‘¨å›ãƒ¬ãƒ¼ã‚¹ ${d.style} ã‚¹ã‚¿ãƒ¼ãƒˆ\n\n`;let f=0;for(let g=0;g<d.data.length&&f<3;g++){if(d.data[g][4]=="")continue;const h=f+1,i=d.data[g][3];let j='';h===1?j='ğŸ¥‡':h===2?j='ğŸ¥ˆ':h===3&&(j='ğŸ¥‰');if(d.mode==1){const k=d.data[g][7];k!=999999?e+=`${j}${h}ä½: ${i} ${msecToSec(k)}\n`:e+=`${j}${h}ä½: ${i} -\n`}else{const k=d.data[g][4],l=d.data[g][5];e+=`${j}${h}ä½: ${i} ${k}å‘¨ ${msecToMin(l)}\n`}f++}e+='\n#RCãƒ¬ãƒ¼ã‚¹';e.length>270&&(e=e.substring(0,250)+'...\n\n#RCãƒ¬ãƒ¼ã‚¹');const m='https://twitter.com/intent/tweet?text='+encodeURIComponent(e);window.open(m,'_blank','width=550,height=420')}function postMultiRaceToX(d){let e='';const f=['','Aãƒ¡ã‚¤ãƒ³','Bãƒ¡ã‚¤ãƒ³','Cãƒ¡ã‚¤ãƒ³'];e+=`ğŸ ${d.title}\n`;d.mode==1?e+=`âš¡ ãƒ™ã‚¹ãƒˆãƒ©ãƒƒãƒ—çµæœ\n\n`:e+=`ğŸƒ å‘¨å›ãƒ¬ãƒ¼ã‚¹çµæœ\n\n`;for(let g=1;g<=d.raceCount;g++){const h=d.raceResults[g]||[];e+=`${f[g]}\n`;let i=0;for(let j=0;j<Math.min(h.length,3);j++){const k=h[j];if(!k||k[4]=="")continue;const l=i+1,m=k[3];let n='';l===1?n='ğŸ¥‡':l===2?n='ğŸ¥ˆ':l===3&&(n='ğŸ¥‰');if(d.mode==1){const o=k[7];o!=999999?e+=`${n}${l}ä½: ${m} ${msecToSec(o)}\n`:e+=`${n}${l}ä½: ${m} -\n`}else{const o=k[4],p=k[5];e+=`${n}${l}ä½: ${m} ${o}å‘¨ ${msecToMin(p)}\n`}i++}g<d.raceCount&&(e+='\n')}e+='\n#RCãƒ¬ãƒ¼ã‚¹';if(e.length>270){e='';e+=`ğŸ ${d.title}\n`;for(let g=1;g<=d.raceCount;g++){const h=d.raceResults[g]||[];if(h.length>0&&h[0][4]!=""){const i=h[0],j=i[3];if(d.mode==1){const k=i[7];k!=999999?e+=`${f[g]}ğŸ¥‡: ${j} ${msecToSec(k)}\n`:e+=`${f[g]}ğŸ¥‡: ${j} -\n`}else{const k=i[4],l=i[5];e+=`${f[g]}ğŸ¥‡: ${j} ${k}å‘¨ ${msecToMin(l)}\n`}}}e+='\n#RCãƒ¬ãƒ¼ã‚¹'}const r='https://twitter.com/intent/tweet?text='+encodeURIComponent(e);window.open(r,'_blank','width=550,height=420')}function getVersionInfo(){const d=document.querySelectorAll('script[src*="jsdelivr.net"]');let e='RC-Race-Results-Generator (Local)';return d.forEach(f=>{const g=f.src,h=g.match(/jsdelivr\.net\/gh\/([^\/]+)\/([^\/]+)@([^\/]+)/);if(h){const[,i,j,k]=h;e=`${i}/${j}@${k}`}}),e}function generateImage(){const d=document.getElementById('table1');if(!d||!d.innerHTML){alert('å…ˆã«é›†è¨ˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');return}const e=document.getElementById('generateImageBtn'),f=e.innerHTML;e.innerHTML='ğŸ“· ç”»åƒç”Ÿæˆä¸­...';e.disabled=true;const g=getVersionInfo(),h=new Date().toLocaleString('ja-JP'),i=document.createElement('div');i.style.position='absolute';i.style.left='-9999px';i.style.top='0';i.style.width=d.offsetWidth+'px';i.style.backgroundColor='#ffffff';i.style.padding='20px';i.style.fontFamily="'ãƒ¡ã‚¤ãƒªã‚ª', 'Meiryo', sans-serif";const j=d.cloneNode(true);i.appendChild(j);const k=document.createElement('div');k.style.textAlign='right';k.style.marginTop='15px';k.style.fontSize='11px';k.style.color='#666';k.style.borderTop='1px solid #ddd';k.style.paddingTop='8px';k.innerHTML=`Generated by: ${g}<br>Date: ${h}`;i.appendChild(k);document.body.appendChild(i);const l={backgroundColor:'#ffffff',scale:2,useCORS:true,allowTaint:false,scrollX:0,scrollY:0,width:i.offsetWidth,height:i.offsetHeight};html2canvas(i,l).then(m=>{try{document.body.removeChild(i);const n=new Date,o=`race-results-${n.getFullYear()}${(n.getMonth()+1).toString().padStart(2,'0')}${n.getDate().toString().padStart(2,'0')}-${n.getHours().toString().padStart(2,'0')}${n.getMinutes().toString().padStart(2,'0')}.png`,p=document.createElement('a');p.download=o;p.href=m.toDataURL('image/png');document.body.appendChild(p);p.click();document.body.removeChild(p);e.innerHTML=f;e.disabled=false;setTimeout(()=>{alert('ç”»åƒã‚’ä¿å­˜ã—ã¾ã—ãŸï¼\nXæŠ•ç¨¿ç”»é¢ã‚’é–‹ãã¾ã™...');q&&postToX()},500)}catch(n){console.error('ç”»åƒä¿å­˜ã‚¨ãƒ©ãƒ¼:',n);document.body.removeChild(i);e.innerHTML=f;e.disabled=false;alert('ç”»åƒä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚')}}).catch(m=>{console.error('html2canvasã‚¨ãƒ©ãƒ¼:',m);document.body.contains(i)&&document.body.removeChild(i);e.innerHTML=f;e.disabled=false;alert('ç”»åƒç”Ÿæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚')})}document.addEventListener('DOMContentLoaded',function(){const d=document.getElementById('repoInfo');d&&(d.textContent=getVersionInfo());updateRaceAreas()});function calc1(d,e){let f=[],g=[];let h=document.getElementById('ta').value;if(h==''){alert('å…ˆã«ãƒ¬ãƒ¼ã‚¹çµæœãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ï¼ï¼');return}h=h.replace('\r\n','\n').trim();let i=h.split("\n");for(let j=0;j<i.length;++j)i[j]=i[j].split(",");console.log('CSVè§£æé–‹å§‹:',i);let k=[],l=[],m=0,n,o=[],p,r=[],s=0,t,u,v=document.getElementById('sb').value;for(let j=0;j<i.length;++j){if(m==1){if(i[j][0]=='ARC4 Manager Race Data'||i[j][0]=='ARC4 Manager User List'){m=0;continue}u=w;for(let x=1;x<s-w+1;++x){i[j][x]&&!isNaN(parseFloat(i[j][x]))&&l[u].push(parseFloat(i[j][x]));++u}}if(m==0&&!isNaN(parseInt(i[j][0]))&&i[j][1]&&!isNaN(parseFloat(i[j][1]))){if(k.length===0||!k[0]){w=0;s=0;for(let x=1;x<i[j].length;++x)if(i[j][x]&&!isNaN(parseFloat(i[j][x]))){let y="ãƒ‰ãƒ©ã‚¤ãƒãƒ¼"+x;v=="with"?k[s]=y+' (H:'+p+')':k[s]=y;l[s]=[];o[s]=n||1;r[s]=p||1;++s}}m=1;u=w;for(let x=1;x<s-w+1;++x){i[j][x]&&!isNaN(parseFloat(i[j][x]))&&l[u].push(parseFloat(i[j][x]));++u}}i[j][0]=="åå‰"&&(m=1,w=s,function(){for(let x=1;x<i[j].length;++x)if(i[j][x]){v=="with"?k[s]=i[j][x]+' (H:'+p+')':k[s]=i[j][x];l[s]=[];o[s]=n;r[s]=p;++s}}());if(i[j][0]=="ãƒãƒ³ãƒ‰"||(i[j][0]==""&&j>0&&i[j-1][0]=="ãƒãƒ³ãƒ‰")){if(i[j][0]=="ãƒãƒ³ãƒ‰"){w=s;for(let x=1;x<i[j].length;++x)if(i[j][x]&&i[j][x].trim()===""){let y="ãƒ‰ãƒ©ã‚¤ãƒãƒ¼"+x;v=="with"?k[s]=y+' (H:'+p+')':k[s]=y;l[s]=[];o[s]=n;r[s]=p;++s}}else i[j][0]==""&&i[j+1]&&!isNaN(parseFloat(i[j+1][1]))&&(m=1)}if(i[j][0]=="ã‚³ãƒ¼ã‚¹"&&j+2<i.length){let x=j+2;while(x<i.length&&(!i[x][1]||isNaN(parseFloat(i[x][1]))))x++;if(x<i.length&&!isNaN(parseFloat(i[x][1]))){w=s;for(let y=1;y<i[j].length;++y)if(y<20){let z="ãƒ‰ãƒ©ã‚¤ãƒãƒ¼"+y;v=="with"?k[s]=z+' (H:'+p+')':k[s]=z;l[s]=[];o[s]=n;r[s]=p;++s}j+1<i.length&&(i[j+1][0]==""||i[j+1][0]=="ãƒãƒ³ãƒ‰")&&j++}}i[j][0]=="ãƒ©ã‚¦ãƒ³ãƒ‰"&&(n=i[j][1]);i[j][0]=="ãƒ’ãƒ¼ãƒˆ"&&(p=i[j][1]);i[j][0]=="ãƒ¬ãƒ¼ã‚¹ã‚¿ã‚¤ãƒˆãƒ«"&&!f.includes(i[j][1])&&f.push(i[j][1]);i[j][0]=="ãƒ¬ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«"&&!g.includes(i[j][1])&&g.push(i[j][1])}var w;console.log('è§£æçµæœ:');console.log('ãƒ‰ãƒ©ã‚¤ãƒãƒ¼:',k);console.log('ãƒ©ãƒƒãƒ—ã‚¿ã‚¤ãƒ :',l);console.log('ãƒ©ã‚¦ãƒ³ãƒ‰:',o);console.log('ãƒ’ãƒ¼ãƒˆ:',r);let A=[],B=[];for(let j=0;j<k.length;++j)k[j]&&(B[j]=[],B[j].push(o[j]),B[j].push(r[j]),B[j].push(j+1),B[j].push(k[j]),B[j]=B[j].concat(totallingPersonal(l[j],o[j],e)));d==1?(B=arrSort(B,1,9),B=arrSort(B,1,7)):(B=arrSort(B,1,9),B=arrSort(B,1,7),B=arrSort(B,1,5),B=arrSort(B,-1,4));let C=removeDuplicates(B);arrDisplayTable(C,d,e,f.join(' '),g.join(' '));switchDisplay();window.print()}function arrDisplayTable(d,e,f,g,h){const i=parseInt(document.querySelector('input[name="raceCount"]:checked').value);i===1?displaySingleRaceTable(d,e,f,g,h):displayMultiRaceTable(d,e,f,g,h,i)}function displaySingleRaceTable(d,e,f,g,h){q={data:d,mode:e,mode2:f,title:g,style:h,isMultiRace:false};let i=[],j=new Date,k=j.getFullYear()+'/'+(j.getMonth()+1)+'/'+j.getDate()+' '+j.getHours()+':'+j.getMinutes();i.push('<table>\n');i.push('<tr class="title"><td colspan="8"><div align="right">'+k+'</div></td></tr>\n');i.push('<tr class="title"><td colspan="8"><div align="left"><b><u>'+g+'</u></b></div></td></tr>\n');e==1?i.push('<tr class="title"><td colspan="8"><div align="left">ãƒ™ã‚¹ãƒˆãƒ©ãƒƒãƒ—ã€€'+h+' ã‚¹ã‚¿ãƒ¼ãƒˆ</div></td></tr>\n'):i.push('<tr class="title"><td colspan="8"><div align="left">å‘¨å›ãƒ¬ãƒ¼ã‚¹ã€€'+h+' ã‚¹ã‚¿ãƒ¼ãƒˆ</div></td></tr>\n');i.push('<tr>\n');i.push('<th></th>\n');i.push('<th></th>\n');i.push('<th colspan="3">1ä½</th>\n');i.push('<th colspan="3">2ä½</th>\n');i.push('</tr>\n');i.push('<tr>\n');i.push('<th>é †ä½</th>\n');i.push('<th>åå‰</th>\n');e==1?(i.push('<th>ãƒ™ã‚¹ãƒˆ</th>\n'),i.push('<th>Rd</th>\n'),i.push('<th>å‘¨</th>\n'),i.push('<th>ãƒ™ã‚¹ãƒˆ</th>\n'),i.push('<th>Rd</th>\n'),i.push('<th>å‘¨</th>\n')):(i.push('<th>å‘¨å›</th>\n'),i.push('<th>ã‚´ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ </th>\n'),i.push('<th>Rd.</th>\n'),i.push('<th>å‘¨å›</th>\n'),i.push('<th>ã‚´ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ </th>\n'),i.push('<th>Rd.</th>\n'));i.push('</tr>\n');for(let l=0;l<d.length;++l){if(d[l][4]=="")continue;i.push('<tr>\n');i.push('<td class="right">'+(l+1)+'</td>\n');i.push('<td              >'+d[l][3]+'</td>\n');if(e==1){let m=d[l][8].split('-'),n="",o="";m.length>1&&(n=m[0],o=m[1]);d[l][7]==999999?i.push('<td class="right"></td>\n'):i.push('<td class="right">'+msecToSec(d[l][7])+'</td>\n');i.push('<td class="right">'+n+'</td>\n');i.push('<td class="right">'+o+'</td>\n');m=d[l][10].split('-');n="";o="";m.length>1&&(n=m[0],o=m[1]);d[l][9]==999999?i.push('<td class="right"></td>\n'):i.push('<td class="right">'+msecToSec(d[l][9])+'</td>\n');i.push('<td class="right">'+n+'</td>\n');i.push('<td class="right">'+o+'</td>\n')}else{i.push('<td class="right">'+d[l][4]+'</td>\n');i.push('<td class="right">'+msecToMin(d[l][5])+'</td>\n');i.push('<td class="right">'+d[l][0]+'</td>\n');i.push('<td class="right">'+d[l][11]+'</td>\n');i.push('<td class="right">'+msecToMin(d[l][12])+'</td>\n');i.push('<td class="right">'+d[l][13]+'</td>\n')}i.push('</tr>\n')}i.push('</table>\n');document.getElementById('table1').innerHTML=i.join('');showActionButtons()}function displayMultiRaceTable(d,e,f,g,h,i){const j=parseMultiRaceResults(d,i);q={data:d,mode:e,mode2:f,title:g,style:h,isMultiRace:true,raceResults:j,raceCount:i};let k=[],l=new Date,m=l.getFullYear()+'/'+(l.getMonth()+1)+'/'+l.getDate()+' '+l.getHours()+':'+l.getMinutes();k.push('<table>\n');k.push('<tr class="title"><td colspan="6"><div align="right">'+m+'</div></td></tr>\n');k.push('<tr class="title"><td colspan="6"><div align="left"><b><u>'+g+'</u></b></div></td></tr>\n');const n=['','Aãƒ¡ã‚¤ãƒ³','Bãƒ¡ã‚¤ãƒ³','Cãƒ¡ã‚¤ãƒ³'];for(let o=1;o<=i;o++){const p=j[o]||[];k.push('<tr class="title"><td colspan="6"><div align="left" style="margin-top: 15px; color: #2c3e50; font-size: 18px;"><b>'+n[o]+'</b></div></td></tr>\n');k.push('<tr>\n');k.push('<th>é †ä½</th>\n');k.push('<th>åå‰</th>\n');e==1?(k.push('<th>ãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒ </th>\n'),k.push('<th>Rd-å‘¨</th>\n'),k.push('<th>2ndãƒ™ã‚¹ãƒˆ</th>\n'),k.push('<th>Rd-å‘¨</th>\n')):(k.push('<th>å‘¨å›æ•°</th>\n'),k.push('<th>ã‚´ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ </th>\n'),k.push('<th>å¹³å‡</th>\n'),k.push('<th>ãƒ™ã‚¹ãƒˆãƒ©ãƒƒãƒ—</th>\n'));k.push('</tr>\n');let r=1;for(let s=0;s<Math.min(p.length,3);s++){const t=p[s];if(!t||t[4]=="")continue;k.push('<tr>\n');k.push('<td class="right">'+r+'</td>\n');k.push('<td>'+t[3]+'</td>\n');if(e==1){t[7]==999999?k.push('<td class="right">-</td>\n'):k.push('<td class="right">'+msecToSec(t[7])+'</td>\n');k.push('<td class="right">'+t[8]+'</td>\n');t[9]==999999?k.push('<td class="right">-</td>\n'):k.push('<td class="right">'+msecToSec(t[9])+'</td>\n');k.push('<td class="right">'+t[10]+'</td>\n')}else{k.push('<td class="right">'+t[4]+'</td>\n');k.push('<td class="right">'+msecToMin(t[5])+'</td>\n');k.push('<td class="right">'+(t[6]?msecToSec(t[6]):'-')+'</td>\n');k.push('<td class="right">'+(t[7]!=999999?msecToSec(t[7]):'-')+'</td>\n')}k.push('</tr>\n');r++}o<i&&k.push('<tr class="title"><td colspan="6" style="height: 10px;"></td></tr>\n')}k.push('</table>\n');document.getElementById('table1').innerHTML=k.join('');showActionButtons()}function parseMultiRaceResults(d,e){const f={},g=['','Aãƒ¡ã‚¤ãƒ³','Bãƒ¡ã‚¤ãƒ³','Cãƒ¡ã‚¤ãƒ³'];for(let h=1;h<=e;h++){f[h]=[];for(let i=0;i<d.length;i++)d[i]&&d[i][4]!=""&&d[i][0]==h&&f[h].push(d[i]);if(f[h].length===0&&d.length>0){const i=Math.ceil(d.filter(j=>j[4]!="").length/e),k=(h-1)*i,l=Math.min(k+i,d.length);for(let m=k;m<l;m++)d[m]&&d[m][4]!=""&&f[h].push(d[m])}}return f}function showActionButtons(){const d=document.getElementById('postToXBtn');d&&(d.style.display='inline-block',d.className='btn-success x-post');const e=document.getElementById('generateImageBtn');e&&(e.style.display='inline-block',e.className='btn-success')}function msecToMin(d){if(d==0)return"";let e=Math.floor(d/60000),f=(d%60000)/1000;if(d%1000==0)return e+":"+f+".000";f<10&&(f="0"+f);f=f+"000";return e+":"+f.slice(0,6)}function msecToSec(d){if(d==0)return"";if(d%1000==0)return d/1000+".000";if(d>=100000)return d=d/1000+"00",d.slice(0,7);return d=d/1000+"00",d.slice(0,6)}function totallingPersonal(d,e,f){let g=0,h=0,i=0,j="",k=999999,l=999999,m="",n="";for(let o=0;o<d.length;++o)if(!isNaN(d[o])){g=g+d[o];i=o+1;if(o>0||f==1){h=h+d[o];if(d[o]<k){l=k;n=m;k=d[o];m=String(e)+'-'+String(o+1)}else d[o]<l&&(l=d[o],n=String(e)+'-'+String(o+1))}}f==1?i>0&&(j=Math.round(g/i)):i>1&&(j=Math.round(h/(i-1)));return[i,g,j,k,m,l,n]}function arrSort(d,e,f){return d.sort(function(g,h){let i=g[f],j=h[f];return e*(i-j)}),d}function arrDisplay(d){let e=[];for(let f=0;f<d.length;++f)e.push(d[f].join('\t'));document.getElementById('ta2').value=e.join('\n')}function removeDuplicates(d){let e=structuredClone(d),f=[],g=[],h={},i=0;for(let j=0;j<e.length;++j)if(g.includes(e[j][3])){if(f[h[e[j][3]]][11]==''){f[h[e[j][3]]][11]=e[j][4];f[h[e[j][3]]][12]=e[j][5];f[h[e[j][3]]][13]=e[j][0];let k=[];k.push([f[h[e[j][3]]][7],f[h[e[j][3]]][8]]);k.push([f[h[e[j][3]]][9],f[h[e[j][3]]][10]]);k.push([e[j][7],e[j][8]]);k.push([e[j][9],e[j][10]]);k=arrSort(k,1,0);f[h[e[j][3]]][7]=k[0][0];f[h[e[j][3]]][8]=k[0][1];f[h[e[j][3]]][9]=k[1][0];f[h[e[j][3]]][10]=k[1][1]}}else{f[i]=e[j];f[i].push('');f[i].push('');f[i].push('');g[i]=e[j][3];h[e[j][3]]=i;++i}return f}let q=null;
