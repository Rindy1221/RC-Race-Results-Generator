const a=document.body,b=document.getElementById('dropArea');let c={1:null,2:null,3:null};a.addEventListener('dragover',d=>{d.preventDefault();d.dataTransfer.dropEffect='copy';b&&b.classList.add('dragover')});a.addEventListener('dragleave',d=>{b&&!a.contains(d.relatedTarget)&&b.classList.remove('dragover')});a.addEventListener('drop',d=>{d.preventDefault();b&&b.classList.remove('dragover');var e=d.dataTransfer.files;getFiles(e)});const getFiles=d=>{if(d.length===0)return;const e=d.length,f=document.getElementById('dropArea');f&&(f.innerHTML=`<div class="drop-text">✅ ${e}個のファイルを読み込み中...</div><div class="drop-subtext">しばらくお待ちください</div>`);let g=0;for(const h of d){const i=new FileReader;i.readAsText(h,'shift-jis');i.onload=j=>{let k=j.target.result;if(k.indexOf('ARC4 Manager Race Data')!==0&&k.indexOf('ARC4 Manager User List')!==0){const l=new FileReader;l.readAsText(h,'utf-8');l.onload=m=>{k=m.target.result;(k.indexOf('ARC4 Manager Race Data')==0||k.indexOf('ARC4 Manager User List')==0)&&(document.getElementById('ta').value=document.getElementById('ta').value+'\n'+k);g++;g===e&&f&&(f.innerHTML=`<div class="drop-text">✅ ${e}個のファイルを正常に読み込みました</div><div class="drop-subtext">集計ボタンを押して結果を表示してください</div>`)};return}(k.indexOf('ARC4 Manager Race Data')==0||k.indexOf('ARC4 Manager User List')==0)&&(document.getElementById('ta').value=document.getElementById('ta').value+'\n'+k);g++;g===e&&f&&(f.innerHTML=`<div class="drop-text">✅ ${e}個のファイルを正常に読み込みました</div><div class="drop-subtext">集計ボタンを押して結果を表示してください</div>`)};i.onerror=()=>{g++;g===e&&f&&(f.innerHTML=`<div class="drop-text">⚠️ ファイル読み込みエラー</div><div class="drop-subtext">もう一度ファイルをドロップしてください</div>`)}}};function updateRaceAreas(){const d=document.querySelector('input[name="raceCount"]:checked').value,e=document.getElementById('singleRaceArea'),f=document.getElementById('multiRaceArea'),g=document.getElementById('raceArea2'),h=document.getElementById('raceArea3');d==='1'?(e.style.display='block',f.style.display='none'):(e.style.display='none',f.style.display='block',g.style.display=d>='2'?'block':'none',h.style.display=d>='3'?'block':'none');c={1:null,2:null,3:null};document.getElementById('ta').value='';document.getElementById('table1').innerHTML='';d>'1'&&setupMultiRaceDropAreas()}function setupMultiRaceDropAreas(){const d=parseInt(document.querySelector('input[name="raceCount"]:checked').value);for(let e=1;e<=d;e++){const f=document.getElementById(`dropAreaRace${e}`);if(f){const g=f.cloneNode(true);f.parentNode.replaceChild(g,f);setupRaceDropArea(e)}}}function setupRaceDropArea(d){const e=document.getElementById(`dropAreaRace${d}`);e.addEventListener('dragover',f=>{f.preventDefault();f.dataTransfer.dropEffect='copy';e.classList.add('dragover')});e.addEventListener('dragleave',f=>{e.contains(f.relatedTarget)||e.classList.remove('dragover')});e.addEventListener('drop',f=>{f.preventDefault();e.classList.remove('dragover');const g=f.dataTransfer.files;getRaceFiles(g,d)})}function getRaceFiles(d,e){if(d.length===0)return;const f=['','Aメイン','Bメイン','Cメイン'],g=document.getElementById(`dropAreaRace${e}`);g&&(g.innerHTML=`<div class="drop-text">✅ ${f[e]}読み込み中...</div><div class="drop-subtext">しばらくお待ちください</div>`);let h=0,i='';for(const j of d){const k=new FileReader;k.readAsText(j,'shift-jis');k.onload=l=>{let m=l.target.result;if(m.indexOf('ARC4 Manager Race Data')!==0&&m.indexOf('ARC4 Manager User List')!==0){const n=new FileReader;n.readAsText(j,'utf-8');n.onload=o=>{m=o.target.result;(m.indexOf('ARC4 Manager Race Data')==0||m.indexOf('ARC4 Manager User List')==0)&&(i+=m+'\n');h++;h===d.length&&(c[e]=i,g&&(g.innerHTML=`<div class="drop-text">✅ ${f[e]}読み込み完了</div><div class="drop-subtext">他のレースも読み込んでから集計してください</div>`),updateTextArea())};return}(m.indexOf('ARC4 Manager Race Data')==0||m.indexOf('ARC4 Manager User List')==0)&&(i+=m+'\n');h++;h===d.length&&(c[e]=i,g&&(g.innerHTML=`<div class="drop-text">✅ ${f[e]}読み込み完了</div><div class="drop-subtext">他のレースも読み込んでから集計してください</div>`),updateTextArea())};k.onerror=()=>{h++;h===d.length&&g&&(g.innerHTML=`<div class="drop-text">⚠️ ${f[e]}読み込みエラー</div><div class="drop-subtext">もう一度ファイルをドロップしてください</div>`)}}}function updateTextArea(){const d=parseInt(document.querySelector('input[name="raceCount"]:checked').value);let e='';if(d===1)return;for(let f=1;f<=d;f++)c[f]&&(e+=c[f]);document.getElementById('ta').value=e}function switchDisplay(d){let e=document.getElementsByClassName("inputArea")[0],f=document.getElementById('btn');(e.style.display==='none'||d==1)?(e.style.display='block',f.innerHTML='📊 印刷用表示に切り替える'):(e.style.display='none',f.innerHTML='📝 入力画面に戻る')}function clear1(){document.getElementById('ta').value='';document.getElementById('table1').innerHTML='';const d=document.getElementById('postToXBtn');d&&(d.style.display='none');const e=document.getElementById('generateImageBtn');e&&(e.style.display='none');q=null;c={1:null,2:null,3:null};const f=document.getElementById('dropArea');f&&(f.innerHTML=`<div class="drop-text">📁 ここにファイルをドラッグ＆ドロップ</div><div class="drop-subtext">ARC4 Managerの結果ファイル (.csv または .arc4) を放り込んでください</div><div class="drop-subtext">複数ファイルを一度にドロップすることも可能です</div>`);const g=['','Aメイン','Bメイン','Cメイン'];for(let h=1;h<=3;h++){const i=document.getElementById(`dropAreaRace${h}`);i&&(i.innerHTML=`<div class="drop-text">📁 ${g[h]}の結果ファイルをドロップ</div><div class="drop-subtext">${g[h]}のレース結果ファイルを放り込んでください</div>`)}switchDisplay(1)}function postToX(){if(!q){alert('投稿するデータがありません。先に集計を実行してください。');return}const d=q;d.isMultiRace?postMultiRaceToX(d):postSingleRaceToX(d)}function postSingleRaceToX(d){let e='';e+=`🏁 ${d.title}\n`;d.mode==1?e+=`⚡ ベストラップ ${d.style} スタート\n\n`:e+=`🏃 周回レース ${d.style} スタート\n\n`;let f=0;for(let g=0;g<d.data.length&&f<3;g++){if(d.data[g][4]=="")continue;const h=f+1,i=d.data[g][3];let j='';h===1?j='🥇':h===2?j='🥈':h===3&&(j='🥉');if(d.mode==1){const k=d.data[g][7];k!=999999?e+=`${j}${h}位: ${i} ${msecToSec(k)}\n`:e+=`${j}${h}位: ${i} -\n`}else{const k=d.data[g][4],l=d.data[g][5];e+=`${j}${h}位: ${i} ${k}周 ${msecToMin(l)}\n`}f++}e+='\n#RCレース';e.length>270&&(e=e.substring(0,250)+'...\n\n#RCレース');const m='https://twitter.com/intent/tweet?text='+encodeURIComponent(e);window.open(m,'_blank','width=550,height=420')}function postMultiRaceToX(d){let e='';const f=['','Aメイン','Bメイン','Cメイン'];e+=`🏁 ${d.title}\n`;d.mode==1?e+=`⚡ ベストラップ結果\n\n`:e+=`🏃 周回レース結果\n\n`;for(let g=1;g<=d.raceCount;g++){const h=d.raceResults[g]||[];e+=`${f[g]}\n`;let i=0;for(let j=0;j<Math.min(h.length,3);j++){const k=h[j];if(!k||k[4]=="")continue;const l=i+1,m=k[3];let n='';l===1?n='🥇':l===2?n='🥈':l===3&&(n='🥉');if(d.mode==1){const o=k[7];o!=999999?e+=`${n}${l}位: ${m} ${msecToSec(o)}\n`:e+=`${n}${l}位: ${m} -\n`}else{const o=k[4],p=k[5];e+=`${n}${l}位: ${m} ${o}周 ${msecToMin(p)}\n`}i++}g<d.raceCount&&(e+='\n')}e+='\n#RCレース';if(e.length>270){e='';e+=`🏁 ${d.title}\n`;for(let g=1;g<=d.raceCount;g++){const h=d.raceResults[g]||[];if(h.length>0&&h[0][4]!=""){const i=h[0],j=i[3];if(d.mode==1){const k=i[7];k!=999999?e+=`${f[g]}🥇: ${j} ${msecToSec(k)}\n`:e+=`${f[g]}🥇: ${j} -\n`}else{const k=i[4],l=i[5];e+=`${f[g]}🥇: ${j} ${k}周 ${msecToMin(l)}\n`}}}e+='\n#RCレース'}const r='https://twitter.com/intent/tweet?text='+encodeURIComponent(e);window.open(r,'_blank','width=550,height=420')}function getVersionInfo(){const d=document.querySelectorAll('script[src*="jsdelivr.net"]');let e='RC-Race-Results-Generator (Local)';return d.forEach(f=>{const g=f.src,h=g.match(/jsdelivr\.net\/gh\/([^\/]+)\/([^\/]+)@([^\/]+)/);if(h){const[,i,j,k]=h;e=`${i}/${j}@${k}`}}),e}function generateImage(){const d=document.getElementById('table1');if(!d||!d.innerHTML){alert('先に集計を実行してください。');return}const e=document.getElementById('generateImageBtn'),f=e.innerHTML;e.innerHTML='📷 画像生成中...';e.disabled=true;const g=getVersionInfo(),h=new Date().toLocaleString('ja-JP'),i=document.createElement('div');i.style.position='absolute';i.style.left='-9999px';i.style.top='0';i.style.width=d.offsetWidth+'px';i.style.backgroundColor='#ffffff';i.style.padding='20px';i.style.fontFamily="'メイリオ', 'Meiryo', sans-serif";const j=d.cloneNode(true);i.appendChild(j);const k=document.createElement('div');k.style.textAlign='right';k.style.marginTop='15px';k.style.fontSize='11px';k.style.color='#666';k.style.borderTop='1px solid #ddd';k.style.paddingTop='8px';k.innerHTML=`Generated by: ${g}<br>Date: ${h}`;i.appendChild(k);document.body.appendChild(i);const l={backgroundColor:'#ffffff',scale:2,useCORS:true,allowTaint:false,scrollX:0,scrollY:0,width:i.offsetWidth,height:i.offsetHeight};html2canvas(i,l).then(m=>{try{document.body.removeChild(i);const n=new Date,o=`race-results-${n.getFullYear()}${(n.getMonth()+1).toString().padStart(2,'0')}${n.getDate().toString().padStart(2,'0')}-${n.getHours().toString().padStart(2,'0')}${n.getMinutes().toString().padStart(2,'0')}.png`,p=document.createElement('a');p.download=o;p.href=m.toDataURL('image/png');document.body.appendChild(p);p.click();document.body.removeChild(p);e.innerHTML=f;e.disabled=false;setTimeout(()=>{alert('画像を保存しました！\nX投稿画面を開きます...');q&&postToX()},500)}catch(n){console.error('画像保存エラー:',n);document.body.removeChild(i);e.innerHTML=f;e.disabled=false;alert('画像保存中にエラーが発生しました。')}}).catch(m=>{console.error('html2canvasエラー:',m);document.body.contains(i)&&document.body.removeChild(i);e.innerHTML=f;e.disabled=false;alert('画像生成中にエラーが発生しました。')})}document.addEventListener('DOMContentLoaded',function(){const d=document.getElementById('repoInfo');d&&(d.textContent=getVersionInfo());updateRaceAreas()});function calc1(d,e){let f=[],g=[];let h=document.getElementById('ta').value;if(h==''){alert('先にレース結果データを読み込んでください！！');return}h=h.replace('\r\n','\n').trim();let i=h.split("\n");for(let j=0;j<i.length;++j)i[j]=i[j].split(",");console.log('CSV解析開始:',i);let k=[],l=[],m=0,n,o=[],p,r=[],s=0,t,u,v=document.getElementById('sb').value;for(let j=0;j<i.length;++j){if(m==1){if(i[j][0]=='ARC4 Manager Race Data'||i[j][0]=='ARC4 Manager User List'){m=0;continue}u=w;for(let x=1;x<s-w+1;++x){i[j][x]&&!isNaN(parseFloat(i[j][x]))&&l[u].push(parseFloat(i[j][x]));++u}}if(m==0&&!isNaN(parseInt(i[j][0]))&&i[j][1]&&!isNaN(parseFloat(i[j][1]))){if(k.length===0||!k[0]){w=0;s=0;for(let x=1;x<i[j].length;++x)if(i[j][x]&&!isNaN(parseFloat(i[j][x]))){let y="ドライバー"+x;v=="with"?k[s]=y+' (H:'+p+')':k[s]=y;l[s]=[];o[s]=n||1;r[s]=p||1;++s}}m=1;u=w;for(let x=1;x<s-w+1;++x){i[j][x]&&!isNaN(parseFloat(i[j][x]))&&l[u].push(parseFloat(i[j][x]));++u}}i[j][0]=="名前"&&(m=1,w=s,function(){for(let x=1;x<i[j].length;++x)if(i[j][x]){v=="with"?k[s]=i[j][x]+' (H:'+p+')':k[s]=i[j][x];l[s]=[];o[s]=n;r[s]=p;++s}}());if(i[j][0]=="バンド"||(i[j][0]==""&&j>0&&i[j-1][0]=="バンド")){if(i[j][0]=="バンド"){w=s;for(let x=1;x<i[j].length;++x)if(i[j][x]&&i[j][x].trim()===""){let y="ドライバー"+x;v=="with"?k[s]=y+' (H:'+p+')':k[s]=y;l[s]=[];o[s]=n;r[s]=p;++s}}else i[j][0]==""&&i[j+1]&&!isNaN(parseFloat(i[j+1][1]))&&(m=1)}if(i[j][0]=="コース"&&j+2<i.length){let x=j+2;while(x<i.length&&(!i[x][1]||isNaN(parseFloat(i[x][1]))))x++;if(x<i.length&&!isNaN(parseFloat(i[x][1]))){w=s;for(let y=1;y<i[j].length;++y)if(y<20){let z="ドライバー"+y;v=="with"?k[s]=z+' (H:'+p+')':k[s]=z;l[s]=[];o[s]=n;r[s]=p;++s}j+1<i.length&&(i[j+1][0]==""||i[j+1][0]=="バンド")&&j++}}i[j][0]=="ラウンド"&&(n=i[j][1]);i[j][0]=="ヒート"&&(p=i[j][1]);i[j][0]=="レースタイトル"&&!f.includes(i[j][1])&&f.push(i[j][1]);i[j][0]=="レーススタイル"&&!g.includes(i[j][1])&&g.push(i[j][1])}var w;console.log('解析結果:');console.log('ドライバー:',k);console.log('ラップタイム:',l);console.log('ラウンド:',o);console.log('ヒート:',r);let A=[],B=[];for(let j=0;j<k.length;++j)k[j]&&(B[j]=[],B[j].push(o[j]),B[j].push(r[j]),B[j].push(j+1),B[j].push(k[j]),B[j]=B[j].concat(totallingPersonal(l[j],o[j],e)));d==1?(B=arrSort(B,1,9),B=arrSort(B,1,7)):(B=arrSort(B,1,9),B=arrSort(B,1,7),B=arrSort(B,1,5),B=arrSort(B,-1,4));let C=removeDuplicates(B);arrDisplayTable(C,d,e,f.join(' '),g.join(' '));switchDisplay();window.print()}function arrDisplayTable(d,e,f,g,h){const i=parseInt(document.querySelector('input[name="raceCount"]:checked').value);i===1?displaySingleRaceTable(d,e,f,g,h):displayMultiRaceTable(d,e,f,g,h,i)}function displaySingleRaceTable(d,e,f,g,h){q={data:d,mode:e,mode2:f,title:g,style:h,isMultiRace:false};let i=[],j=new Date,k=j.getFullYear()+'/'+(j.getMonth()+1)+'/'+j.getDate()+' '+j.getHours()+':'+j.getMinutes();i.push('<table>\n');i.push('<tr class="title"><td colspan="8"><div align="right">'+k+'</div></td></tr>\n');i.push('<tr class="title"><td colspan="8"><div align="left"><b><u>'+g+'</u></b></div></td></tr>\n');e==1?i.push('<tr class="title"><td colspan="8"><div align="left">ベストラップ　'+h+' スタート</div></td></tr>\n'):i.push('<tr class="title"><td colspan="8"><div align="left">周回レース　'+h+' スタート</div></td></tr>\n');i.push('<tr>\n');i.push('<th></th>\n');i.push('<th></th>\n');i.push('<th colspan="3">1位</th>\n');i.push('<th colspan="3">2位</th>\n');i.push('</tr>\n');i.push('<tr>\n');i.push('<th>順位</th>\n');i.push('<th>名前</th>\n');e==1?(i.push('<th>ベスト</th>\n'),i.push('<th>Rd</th>\n'),i.push('<th>周</th>\n'),i.push('<th>ベスト</th>\n'),i.push('<th>Rd</th>\n'),i.push('<th>周</th>\n')):(i.push('<th>周回</th>\n'),i.push('<th>ゴールタイム</th>\n'),i.push('<th>Rd.</th>\n'),i.push('<th>周回</th>\n'),i.push('<th>ゴールタイム</th>\n'),i.push('<th>Rd.</th>\n'));i.push('</tr>\n');for(let l=0;l<d.length;++l){if(d[l][4]=="")continue;i.push('<tr>\n');i.push('<td class="right">'+(l+1)+'</td>\n');i.push('<td              >'+d[l][3]+'</td>\n');if(e==1){let m=d[l][8].split('-'),n="",o="";m.length>1&&(n=m[0],o=m[1]);d[l][7]==999999?i.push('<td class="right"></td>\n'):i.push('<td class="right">'+msecToSec(d[l][7])+'</td>\n');i.push('<td class="right">'+n+'</td>\n');i.push('<td class="right">'+o+'</td>\n');m=d[l][10].split('-');n="";o="";m.length>1&&(n=m[0],o=m[1]);d[l][9]==999999?i.push('<td class="right"></td>\n'):i.push('<td class="right">'+msecToSec(d[l][9])+'</td>\n');i.push('<td class="right">'+n+'</td>\n');i.push('<td class="right">'+o+'</td>\n')}else{i.push('<td class="right">'+d[l][4]+'</td>\n');i.push('<td class="right">'+msecToMin(d[l][5])+'</td>\n');i.push('<td class="right">'+d[l][0]+'</td>\n');i.push('<td class="right">'+d[l][11]+'</td>\n');i.push('<td class="right">'+msecToMin(d[l][12])+'</td>\n');i.push('<td class="right">'+d[l][13]+'</td>\n')}i.push('</tr>\n')}i.push('</table>\n');document.getElementById('table1').innerHTML=i.join('');showActionButtons()}function displayMultiRaceTable(d,e,f,g,h,i){const j=parseMultiRaceResults(d,i);q={data:d,mode:e,mode2:f,title:g,style:h,isMultiRace:true,raceResults:j,raceCount:i};let k=[],l=new Date,m=l.getFullYear()+'/'+(l.getMonth()+1)+'/'+l.getDate()+' '+l.getHours()+':'+l.getMinutes();k.push('<table>\n');k.push('<tr class="title"><td colspan="6"><div align="right">'+m+'</div></td></tr>\n');k.push('<tr class="title"><td colspan="6"><div align="left"><b><u>'+g+'</u></b></div></td></tr>\n');const n=['','Aメイン','Bメイン','Cメイン'];for(let o=1;o<=i;o++){const p=j[o]||[];k.push('<tr class="title"><td colspan="6"><div align="left" style="margin-top: 15px; color: #2c3e50; font-size: 18px;"><b>'+n[o]+'</b></div></td></tr>\n');k.push('<tr>\n');k.push('<th>順位</th>\n');k.push('<th>名前</th>\n');e==1?(k.push('<th>ベストタイム</th>\n'),k.push('<th>Rd-周</th>\n'),k.push('<th>2ndベスト</th>\n'),k.push('<th>Rd-周</th>\n')):(k.push('<th>周回数</th>\n'),k.push('<th>ゴールタイム</th>\n'),k.push('<th>平均</th>\n'),k.push('<th>ベストラップ</th>\n'));k.push('</tr>\n');let r=1;for(let s=0;s<Math.min(p.length,3);s++){const t=p[s];if(!t||t[4]=="")continue;k.push('<tr>\n');k.push('<td class="right">'+r+'</td>\n');k.push('<td>'+t[3]+'</td>\n');if(e==1){t[7]==999999?k.push('<td class="right">-</td>\n'):k.push('<td class="right">'+msecToSec(t[7])+'</td>\n');k.push('<td class="right">'+t[8]+'</td>\n');t[9]==999999?k.push('<td class="right">-</td>\n'):k.push('<td class="right">'+msecToSec(t[9])+'</td>\n');k.push('<td class="right">'+t[10]+'</td>\n')}else{k.push('<td class="right">'+t[4]+'</td>\n');k.push('<td class="right">'+msecToMin(t[5])+'</td>\n');k.push('<td class="right">'+(t[6]?msecToSec(t[6]):'-')+'</td>\n');k.push('<td class="right">'+(t[7]!=999999?msecToSec(t[7]):'-')+'</td>\n')}k.push('</tr>\n');r++}o<i&&k.push('<tr class="title"><td colspan="6" style="height: 10px;"></td></tr>\n')}k.push('</table>\n');document.getElementById('table1').innerHTML=k.join('');showActionButtons()}function parseMultiRaceResults(d,e){const f={},g=['','Aメイン','Bメイン','Cメイン'];for(let h=1;h<=e;h++){f[h]=[];for(let i=0;i<d.length;i++)d[i]&&d[i][4]!=""&&d[i][0]==h&&f[h].push(d[i]);if(f[h].length===0&&d.length>0){const i=Math.ceil(d.filter(j=>j[4]!="").length/e),k=(h-1)*i,l=Math.min(k+i,d.length);for(let m=k;m<l;m++)d[m]&&d[m][4]!=""&&f[h].push(d[m])}}return f}function showActionButtons(){const d=document.getElementById('postToXBtn');d&&(d.style.display='inline-block',d.className='btn-success x-post');const e=document.getElementById('generateImageBtn');e&&(e.style.display='inline-block',e.className='btn-success')}function msecToMin(d){if(d==0)return"";let e=Math.floor(d/60000),f=(d%60000)/1000;if(d%1000==0)return e+":"+f+".000";f<10&&(f="0"+f);f=f+"000";return e+":"+f.slice(0,6)}function msecToSec(d){if(d==0)return"";if(d%1000==0)return d/1000+".000";if(d>=100000)return d=d/1000+"00",d.slice(0,7);return d=d/1000+"00",d.slice(0,6)}function totallingPersonal(d,e,f){let g=0,h=0,i=0,j="",k=999999,l=999999,m="",n="";for(let o=0;o<d.length;++o)if(!isNaN(d[o])){g=g+d[o];i=o+1;if(o>0||f==1){h=h+d[o];if(d[o]<k){l=k;n=m;k=d[o];m=String(e)+'-'+String(o+1)}else d[o]<l&&(l=d[o],n=String(e)+'-'+String(o+1))}}f==1?i>0&&(j=Math.round(g/i)):i>1&&(j=Math.round(h/(i-1)));return[i,g,j,k,m,l,n]}function arrSort(d,e,f){return d.sort(function(g,h){let i=g[f],j=h[f];return e*(i-j)}),d}function arrDisplay(d){let e=[];for(let f=0;f<d.length;++f)e.push(d[f].join('\t'));document.getElementById('ta2').value=e.join('\n')}function removeDuplicates(d){let e=structuredClone(d),f=[],g=[],h={},i=0;for(let j=0;j<e.length;++j)if(g.includes(e[j][3])){if(f[h[e[j][3]]][11]==''){f[h[e[j][3]]][11]=e[j][4];f[h[e[j][3]]][12]=e[j][5];f[h[e[j][3]]][13]=e[j][0];let k=[];k.push([f[h[e[j][3]]][7],f[h[e[j][3]]][8]]);k.push([f[h[e[j][3]]][9],f[h[e[j][3]]][10]]);k.push([e[j][7],e[j][8]]);k.push([e[j][9],e[j][10]]);k=arrSort(k,1,0);f[h[e[j][3]]][7]=k[0][0];f[h[e[j][3]]][8]=k[0][1];f[h[e[j][3]]][9]=k[1][0];f[h[e[j][3]]][10]=k[1][1]}}else{f[i]=e[j];f[i].push('');f[i].push('');f[i].push('');g[i]=e[j][3];h[e[j][3]]=i;++i}return f}let q=null;
